import{_ as P,k as R,m as U,o,c as n,a as e,t as k,u as t,n as z,q as j,p as O,g as G,s as W,w as F,v as ce,l as A,T as pe,r as d,x as M,y as T,F as E,z as L,A as q,b as H,d as Q,h as he,B as fe,i as ne,C as ie,E as ge,e as ke}from"./index-d228b13b.js";import{d as de,l as Z,c as X,a as be,g as ye,p as $e,b as Ce,e as Ie,w as ae,n as le}from"./loading-ba35dbae.js";import{i as ue,d as re,b as oe,p as we,f as De,c as Me,e as xe}from"./index-e0cda566.js";const Se=s=>(O("data-v-55b1c2e4"),s=s(),G(),s),Te={class:"top"},ze={class:"time"},Ne={class:"label"},Be={class:"foot"},Pe={class:"foot-left"},Ve={class:"value"},Ae={class:"icon"},Ee=Se(()=>e("span",{class:"iconfont icon-liuyan"},null,-1)),Le={class:"value"},Ue={class:"name"},We={__name:"NodeCard",props:{width:{default:"100%"},note:{default:{}}},emits:["toDetail"],setup(s,{emit:h}){const f=s,r=R();var a=U(()=>f.note);const v=()=>{h("toDetail")},_=()=>{if(a.value.islike[0].count==0){let c={wallId:a.value.id,userId:r.state.user.id,type:0,moment:new Date};ue(c).then(m=>{a.value.like[0].count++,a.value.islike[0].count++})}};return(c,m)=>(o(),n("div",{class:"i-node-card",style:j({width:s.width,background:t(X)[t(a).color]})},[e("div",Te,[e("p",ze,k(t(de)(t(a).moment)),1),e("p",Ne,k(t(Z)[t(a).type][t(a).label]),1)]),e("p",{class:"message",onClick:v},k(t(a).message),1),e("div",Be,[e("div",Pe,[e("div",{class:"icon",onClick:_},[e("span",{class:z(["iconfont icon-aixin1",{islike:t(a).islike[0].count>=1}])},null,2),e("span",Ve,k(t(a).like[0].count),1)]),e("div",Ae,[Ee,e("span",Le,k(t(a).comcount[0].count),1)])]),e("div",Ue,k(t(a).name),1)])],4))}},ve=P(We,[["__scopeId","data-v-55b1c2e4"]]);const Fe={class:"photo-card"},He=["src"],Re={class:"photo-like"},je={class:"like-data"},qe={__name:"PhotoCard",props:{photoItem:{default:{}}},emits:["toDetail"],setup(s,{emit:h}){const f=s,r=R(),a=U(()=>f.photoItem),v=()=>{h("toDetail",a.value.id)},_=()=>{if(a.value.islike[0].count==0){let c={wallId:a.value.id,userId:r.state.user.id,type:0,moment:new Date};ue(c).then(m=>{a.value.like[0].count++,a.value.islike[0].count++})}};return(c,m)=>(o(),n("div",Fe,[e("img",{src:t(re)+t(a).imgurl,class:"photo-img"},null,8,He),e("div",{class:"photo-bg",onClick:v}),e("div",Re,[e("span",{class:z(["iconfont icon-aixin1",{islike:t(a).islike[0].count>=1}]),onClick:_},null,2),e("span",je,k(t(a).like[0].count),1)])]))}},Oe=P(qe,[["__scopeId","data-v-cff64342"]]);const Ge={key:0,class:"i-modal"},Je={class:"i-modal-head"},Ke={class:"modal-name"},Qe={class:"i-modal-main"},Xe={__name:"IModal",props:{title:{default:"留言墙"},isModal:{default:!1}},emits:["close"],setup(s,{emit:h}){const f=()=>{h("close")};return(r,a)=>(o(),W(pe,{name:"modal"},{default:F(()=>[s.isModal?(o(),n("div",Ge,[e("div",Je,[e("p",Ke,k(s.title),1),e("span",{class:"iconfont icon-guanbi",onClick:f})]),e("div",Qe,[ce(r.$slots,"default",{},void 0,!0)])])):A("",!0)]),_:3}))}},Ye=P(Xe,[["__scopeId","data-v-4a4b06dc"]]);const Ze={__name:"Ibutton",props:{size:{default:"base"},active:{default:"primary"}},setup(s){return(h,f)=>(o(),n("div",null,[e("button",{class:z([[s.size,s.active],"btn"])},[ce(h.$slots,"default",{},void 0,!0)],2)]))}},Y=P(Ze,[["__scopeId","data-v-39ea20f1"]]);const ee=s=>(O("data-v-957495df"),s=s(),G(),s),et={class:"new-card"},tt={class:"colors"},st=["onClick"],at={key:0,class:"add-photo"},lt={key:0,class:"add-bt"},ot=ee(()=>e("span",{class:"iconfont icon-tianjia"},null,-1)),ct=[ot],nt={key:1,class:"change-bt"},it=ee(()=>e("span",{class:"iconfont icon-xiugai"},null,-1)),dt=[it],ut={class:"photo-div"},rt=["src"],vt={class:"labels"},_t=ee(()=>e("p",{class:"title"},"选择标签",-1)),mt={class:"label"},pt=["onClick"],ht=he('<div data-v-957495df><p class="title" data-v-957495df>免责声明</p><p class="mzsm" data-v-957495df> 青一录 是LiRayShield、皮皮和MGT等人开发的，为便于与用户交流的留言平台。请不要利用此平台服务制作、上传、下载、复制、发布、传播或者转载如下内容：<br data-v-957495df> 1、反对宪法所确定的基本原则的；<br data-v-957495df> 2、危害国家安全，泄露国家秘密，颠覆国家政权，破坏国家 统一的；<br data-v-957495df> 3、损害国家荣誉和利益的；<br data-v-957495df> 4、煽动民族仇恨、民族歧视，破坏民族团结的；<br data-v-957495df> 5、破坏国家宗教政策，宣扬邪教和封建迷信的；<br data-v-957495df> 6、散布谣言，扰乱社会秩序，破坏社会稳定的；<br data-v-957495df> 7、散布淫秽、色情、赌博、暴力、凶杀、恐怖或者教唆犯罪的；<br data-v-957495df> 8、侮辱或者诽谤他人，侵害他人合法权益的；<br data-v-957495df> 9、含有法律、行政法规禁止的其他内容的信息等。<br data-v-957495df> 10.墙主邮箱：LiRayShield@outlook.com </p></div>',1),ft={class:"btn1"},gt={__name:"NewCard",props:{id:{default:0}},emits:["closeModal","clickbt"],setup(s,{emit:h}){const f=s,{appContext:r}=fe(),a=r.config.globalProperties,v=R();var _=d("");const c=d(""),m=d(""),C=d(0),g=d(0),x=v.state.user,S=i=>{C.value=i},b=i=>{g.value=i},p=i=>{h("closeModal",i)},l=()=>{let i="匿名";m.value&&(i=m.value);let w={type:f.id,message:c.value,name:i,userId:x.id,moment:new Date,label:g.value,color:5,imgurl:""};c.value&&f.id==0?(w.color=C.value,oe(w).then(y=>{let $={type:f.id,message:c.value,name:i,userId:x.id,moment:new Date,label:g.value,imgurl:"",id:y.message.insertId,islike:[{count:0}],like:[{count:0}],comcount:[{count:0}],report:[{count:0}],revoke:[{count:0}],color:C.value};c.value="",h("clickbt",$),a.Modal({type:"success",message:"感谢您的记录"})})):f.id==1&&_.value&&J(w)},V=()=>{let i=ye(document.getElementById("file").files[0]);_.value=i},J=i=>{let w=document.getElementById("file");if(w.files.length>0){let y=new FormData;y.append("file",w.files[0]),we(y).then($=>{i.imgurl=$,oe(i).then(N=>{let K={type:f.id,message:c.value,name:i.name,userId:x.id,moment:new Date,label:g.value,color:5,imgurl:$,id:N.message.insertId,islike:[{count:0}],like:[{count:0}],comcount:[{count:0}],report:[{count:0}],revoke:[{count:0}],color:C.value};c.value="",h("clickbt",K),a.Modal({type:"success",message:"感谢您的记录"})})})}};return(i,w)=>(o(),n("div",et,[M(e("div",tt,[(o(!0),n(E,null,L(t(be),(y,$)=>(o(),n("p",{class:z(["color-item",{colorselected:$==C.value}]),key:$,style:j({background:y}),onClick:N=>S($)},null,14,st))),128))],512),[[T,s.id==0]]),s.id==1?(o(),n("div",at,[e("input",{type:"file",name:"file",id:"file",multiple:"multiple",onChange:V},null,32),t(_)==""?(o(),n("div",lt,ct)):A("",!0),t(_)!=""?(o(),n("div",nt,dt)):A("",!0),M(e("div",ut,[e("img",{src:t(_)},null,8,rt)],512),[[T,t(_)!=""]])])):A("",!0),e("div",{class:"card-main",style:j({background:s.id==0?t(X)[C.value]:t(X)[5]})},[M(e("textarea",{placeholder:"留言...",class:"message",maxlength:"96","onUpdate:modelValue":w[0]||(w[0]=y=>c.value=y)},null,512),[[q,c.value]]),M(e("input",{type:"text",placeholder:"签名",class:"name","onUpdate:modelValue":w[1]||(w[1]=y=>m.value=y)},null,512),[[q,m.value]])],4),e("div",vt,[_t,e("div",mt,[(o(!0),n(E,null,L(t(Z)[s.id],(y,$)=>(o(),n("p",{key:$,class:z(["label-item",{labelselected:$==g.value}]),onClick:N=>b($)},k(y),11,pt))),128))])]),ht,e("div",ft,[H(Y,{size:"max",active:"secondary",onClick:p},{default:F(()=>[Q("丢弃")]),_:1}),H(Y,{size:"max",class:"sbumit",onClick:l},{default:F(()=>[Q("确定")]),_:1})])]))}},kt=P(gt,[["__scopeId","data-v-957495df"]]);const bt=s=>(O("data-v-4726efb3"),s=s(),G(),s),yt={class:"card-detail"},$t=bt(()=>e("p",{class:"report"},null,-1)),Ct={key:0,class:"add-photo"},It={class:"photo-div"},wt=["src"],Dt={class:"form"},Mt={class:"bt"},xt={class:"title"},St={class:"comment"},Tt={class:"comment-content"},zt={class:"comment-top"},Nt={class:"name"},Bt={class:"time"},Pt={class:"comment-message"},Vt={__name:"CardDetail",props:{card:{default:{}},id:{default:""}},setup(s){const h=s,f=R();ne(()=>{x()}),console.log(h.card);const r=d(1),a=d(3);var v=!0;const _=d(""),c=d("");var m=U(()=>h.card);ie(()=>h.card,()=>{r.value=1,C.value=[],x()});const C=d([]);v=U(()=>!!(_.value&&c.value));const g=()=>{if(v.value){let b=Math.floor(Math.random()*14),p={wallId:m.value.id,userId:f.state.user.id,imgurl:b,moment:new Date,comment:_.value,name:c.value};Me(p).then(l=>{C.value.unshift(p),m.value.comcount[0].count++,_.value=""})}},x=()=>{if(r.value>0){let b={id:m.value.id,page:r.value,pagesize:a.value};De(b).then(p=>{C.value=C.value.concat(p.message),p.message.length==a.value?r.value++:r.value=0})}},S=()=>{console.log(1),globalProxy.Modal({type:"success",message:"已成功通知到墙主！"})};return(b,p)=>(o(),n("div",yt,[e("div",{class:"top-bt"},[e("p",{class:"revoke",onClick:S},"撕掉该便签请联系墙主"),$t]),s.id==1?(o(),n("div",Ct,[M(e("div",It,[e("img",{src:t(re)+s.card.imgurl},null,8,wt)],512),[[T,s.card.imgurl!=""]])])):A("",!0),H(ve,{note:t(m)},null,8,["note"]),e("div",Dt,[M(e("textarea",{class:"message",placeholder:"请输入...","onUpdate:modelValue":p[0]||(p[0]=l=>_.value=l)},null,512),[[q,_.value]]),e("div",Mt,[M(e("input",{type:"text",class:"name",placeholder:"签名","onUpdate:modelValue":p[1]||(p[1]=l=>c.value=l)},null,512),[[q,c.value]]),H(Y,{class:z({notallowed:!t(v)}),onClick:g},{default:F(()=>[Q("确定")]),_:1},8,["class"])])]),e("p",xt,"评论"+k(t(m).comcount[0].count),1),e("div",St,[(o(!0),n(E,null,L(C.value,(l,V)=>(o(),n("div",{class:"comment-item",key:V},[e("div",{class:"user-head",style:j({backgroundImage:t($e)[l.imgurl]})},null,4),e("div",Tt,[e("div",zt,[e("p",Nt,k(l.name),1),e("p",Bt,k(t(de)(l.moment)),1)]),e("div",Pt,k(l.comment),1)])]))),128)),M(e("p",{class:"more",onClick:x},"加载更多",512),[[T,r.value>0]])])]))}},At=P(Vt,[["__scopeId","data-v-4726efb3"]]);const te=s=>(O("data-v-f5cdcc51"),s=s(),G(),s),Et={class:"wall-message"},Lt={class:"label"},Ut=["onClick"],Wt={class:"title"},Ft={class:"slogan"},Ht={class:"card"},Rt=te(()=>e("span",{class:"iconfont icon-tianjia"},null,-1)),jt=[Rt],qt={class:"photo"},Ot={key:0,class:"none-msg"},Gt=["src"],Jt={class:"loading"},Kt=te(()=>e("div",{id:"lottile"},null,-1)),Qt=te(()=>e("p",null,"加载中....",-1)),Xt=[Kt,Qt],Yt={class:"bottom-tip"},Zt={__name:"WallMessage",setup(s){const h=ke(),f=R();ne(()=>{window.addEventListener("scroll",w),J(),me()});const r=d(!1),a=d(!1),v=d(-1);var _=U(()=>f.state.user);const c=d([]),m=d("写留言"),C=d(20),g=d(-1);var x=!1;const S=d(1),b=d([]),p=d(-1);var l=U(()=>h.query.id);const V=u=>{p.value=u,b.value=[],S.value=1,i(l.value)},J=()=>{let u=setInterval(()=>{f.state.user&&(clearInterval(u),i(l.value))},10)},i=u=>{if(x=!0,S.value>0){g.value=-1;let B={type:u,page:S.value,pagesize:C.value,userId:_.value.id,label:p.value};xe(B).then(D=>{if(b.value=b.value.concat(D.message),D.message.length?S.value++:S.value=0,b.value.length>0?(g.value=1,S.value==0&&(g.value=2)):g.value=0,u==1)for(let I=0;I<D.message.length;I++)c.value.push(D.message[I].imgurl);x=!1})}},w=async()=>{let u=document.documentElement.scrollTop||document.body.scrollTop,B=document.documentElement.clientHeight,D=document.documentElement.scrollHeight;Math.ceil(u)+B>=D-200&&!x&&i(l.value)},y=d(0),$=u=>{if(m.value="",u!=v.value){v.value=u,a.value=!0,l.value==1&&(y.value=1);return}v.value=-1,a.value=!1,l.value==1&&(r.value=!1)},N=()=>{v.value=-1,y.value=0,a.value=!1,l.value==1&&(r.value=!1)};ie(l,(u,B)=>{S.value=1,a.value=!1,r.value=!1,p.value=-1,v.value=-1,b.value=[],i(u)});const K=u=>{b.value.unshift(u),u.type==1&&c.value.unshift(u.imgurl),g.value=1,N()},_e=()=>{m.value="写留言",a.value=!0};var me=()=>{(g.value=-1)&&ge(async()=>{var u={container:document.getElementById("lottile"),renderer:"svg",loop:!0,autoplay:!0,animationData:Ce};Ie.loadAnimation(u)})};return(u,B)=>(o(),n("div",Et,[e("div",Lt,[e("p",{class:z(["label-list",{lbselected:p.value==-1}]),onClick:B[0]||(B[0]=D=>V(-1))},"全部",2),(o(!0),n(E,null,L(t(Z)[t(l)],(D,I)=>(o(),n("p",{class:z(["label-list",{lbselected:p.value==I}]),key:I,onClick:se=>V(I)},k(D),11,Ut))),128))]),e("p",Wt,k(t(ae)[t(l)].name),1),e("p",Ft,k(t(ae)[t(l)].slogan),1),M(e("div",Ht,[(o(!0),n(E,null,L(b.value,(D,I)=>(o(),W(ve,{class:z(["card-inner",{cardselected:I==v.value}]),onToDetail:se=>$(I),note:D,key:I},null,8,["class","onToDetail","note"]))),128))],512),[[T,t(l)==0]]),M(e("div",{class:"add",style:{bottom:"30px"},onClick:_e},jt,512),[[T,!a.value]]),M(e("div",qt,[(o(!0),n(E,null,L(b.value,(D,I)=>(o(),W(Oe,{photoItem:D,class:"photo-card",key:I,onToDetail:se=>$(I)},null,8,["photoItem","onToDetail"]))),128))],512),[[T,t(l)==1]]),H(Ye,{title:m.value,onClose:N,isModal:a.value},{default:F(()=>[v.value==-1?(o(),W(kt,{key:0,onClickbt:K,id:t(l),onCloseModal:N},null,8,["id"])):(o(),W(At,{key:1,card:b.value[v.value],id:t(l)},null,8,["card","id"]))]),_:1},8,["title","isModal"]),g.value==0?(o(),n("div",Ot,[e("img",{src:t(le)[t(l)].url},null,8,Gt),e("p",null,k(t(le)[t(l)].msg),1)])):A("",!0),M(e("div",Jt,Xt,512),[[T,g.value==-1]]),M(e("p",Yt," -我是有底线的- ",512),[[T,g.value==2]])]))}},as=P(Zt,[["__scopeId","data-v-f5cdcc51"]]);export{as as default};
